RAG (Retrieval-Augmented Generation) 问答系统

什么是 RAG？
RAG 是一种结合了检索和生成的AI技术。它首先从知识库中检索相关信息，然后使用大语言模型基于检索到的信息生成回答。这种方法可以显著提高回答的准确性和可靠性。

RAG 的核心组件
1. 文档加载器（Document Loader）：负责加载各种格式的文档
2. 文本分割器（Text Splitter）：将长文档分割成适当大小的文本块
3. 向量数据库（Vector Store）：存储文档的向量表示，支持相似性搜索
4. 嵌入模型（Embeddings）：将文本转换为向量表示
5. 检索器（Retriever）：从向量数据库中检索相关文档
6. 大语言模型（LLM）：基于检索到的上下文生成回答

本项目使用的技术栈
- LangChain：用于构建 RAG 应用的框架
- FAISS：Facebook AI 开发的高效向量搜索库
- OpenAI GPT-3.5-turbo：用于生成回答的大语言模型
- Flask：轻量级 Web 框架，提供 API 接口

项目部署架构
本项目采用现代化的云原生部署架构：
1. Docker 容器化：应用打包为 Docker 镜像
2. AWS ECR：存储 Docker 镜像
3. AWS App Runner：无服务器容器部署服务
4. Terraform：基础设施即代码，自动化创建云资源
5. GitHub Actions：CI/CD 自动化部署流水线
6. Cloudflare：提供 CDN 和域名管理服务

DevOps 最佳实践
本项目展示了多个 DevOps 最佳实践：
- 基础设施即代码（IaC）：使用 Terraform 管理云资源
- 容器化：使用 Docker 确保环境一致性
- CI/CD 自动化：通过 GitHub Actions 实现持续集成和部署
- 安全管理：使用 AWS Secrets Manager 管理敏感信息
- OIDC 认证：使用 OpenID Connect 实现无密钥的安全认证

GitHub Actions OIDC
OIDC (OpenID Connect) 是一种基于 OAuth 2.0 的身份认证协议。使用 OIDC，GitHub Actions 可以直接向 AWS 请求临时访问凭证，而不需要在仓库中存储长期有效的 AWS 访问密钥。这大大提高了安全性。

AWS App Runner 的优势
AWS App Runner 是一个全托管的容器化应用部署服务，具有以下优势：
1. 自动扩展：根据流量自动调整容器数量
2. 零配置：无需管理服务器或 Kubernetes 集群
3. 内置负载均衡：自动分配流量
4. HTTPS 支持：自动提供 SSL/TLS 证书
5. 健康检查：自动监控应用健康状态
6. 快速部署：从代码到生产环境只需几分钟

Terraform 的作用
Terraform 是一个基础设施即代码工具，允许你使用声明式配置文件来定义和管理云资源。在本项目中，Terraform 负责创建：
- ECR 仓库：存储 Docker 镜像
- IAM 角色：管理权限
- Secrets Manager：存储 API 密钥
- App Runner 服务：运行应用容器

使用本系统
本系统提供了简单的 REST API 接口：
- POST /ask：提交问题并获取回答
- GET /：健康检查
- GET /health：系统状态
- GET /info：系统信息

示例请求：
```json
{
  "question": "什么是 RAG？"
}
```

示例响应：
```json
{
  "question": "什么是 RAG？",
  "answer": "RAG 是一种结合了检索和生成的AI技术...",
  "sources": [...]
}
```

学习资源
如果你想深入学习相关技术，推荐以下资源：
- LangChain 官方文档：https://python.langchain.com/
- AWS 官方文档：https://docs.aws.amazon.com/
- Terraform 教程：https://developer.hashicorp.com/terraform/tutorials
- GitHub Actions 文档：https://docs.github.com/en/actions
- Docker 文档：https://docs.docker.com/

常见问题
Q: 为什么选择 FAISS 而不是其他向量数据库？
A: FAISS 是一个高效的向量搜索库，特别适合中小规模的应用。它可以直接嵌入应用中，无需单独部署数据库服务。

Q: 如何更新知识库？
A: 更新 data.txt 文件后，重新运行 ingest.py 脚本即可重新生成向量索引。

Q: 如何控制成本？
A: 可以通过以下方式控制成本：
1. 不使用时删除 App Runner 服务
2. 使用 OpenAI 的较小模型
3. 减少向量检索的文档数量
4. 设置 App Runner 的最小实例数为 1

Q: 支持哪些文档格式？
A: 目前支持纯文本格式。如需支持 PDF、Word 等格式，可以使用 LangChain 提供的其他文档加载器。

贡献和反馈
这是一个教学项目，欢迎提出问题和建议。通过这个项目，你可以学习到：
- 如何构建生产级的 AI 应用
- 如何实现完整的 CI/CD 流程
- 如何使用云原生技术部署应用
- 如何应用 DevOps 最佳实践

项目路线图
未来可能的改进方向：
1. 支持多种文档格式（PDF、Word、网页等）
2. 添加用户界面（Web UI）
3. 支持对话历史
4. 实现多租户支持
5. 添加监控和日志分析
6. 支持更多的向量数据库（如 Pinecone、Weaviate）
7. 添加用户认证和授权
8. 实现缓存机制提高性能

总结
本项目展示了一个完整的、可用于生产环境的 RAG 应用开发和部署流程。通过学习本项目，你将掌握现代化的 AI 应用开发和 DevOps 实践。

================================================================================
星露谷物语 (Stardew Valley) 知识库
================================================================================

游戏简介
《星露谷物语》是一款由 ConcernedApe（Eric Barone）独立开发的农场模拟角色扮演游戏。玩家继承了祖父在星露谷的旧农场，需要通过种植作物、饲养动物、挖矿、钓鱼、与村民交往等方式重建农场并融入小镇生活。

可结婚的村民

艾利欧特 (Elliott)
居住在海滩上的浪漫作家，喜欢诗歌和文学。他优雅而有教养，梦想成为一名著名作家。
最爱的礼物：龙虾、蟹黄糕、鸭毛、石榴、兔子的脚
喜欢的礼物：所有宝石、所有水果（除了山核桃和榛子）、鲍鱼、龙虾汤
生日：秋季 5 日
位置：海滩小屋

哈维 (Harvey)
小镇唯一的医生，谨慎而有责任心。他对飞机和航空有浓厚兴趣，但因恐高症未能实现飞行员梦想。
最爱的礼物：咖啡、泡菜、超级海参、松露、葡萄酒
喜欢的礼物：鸭毛、山核桃、榛子、所有水果
生日：冬季 14 日
位置：诊所

山姆 (Sam)
乐观开朗的年轻人，喜欢音乐和滑板。他在 JojaMart 工作，梦想成为一名职业音乐家。
最爱的礼物：仙人掌果实、披萨、虎眼石
喜欢的礼物：枫糖浆、所有鸡蛋
生日：夏季 17 日
位置：1 柳巷街 1 号（与父母和弟弟同住）

塞巴斯蒂安 (Sebastian)
内向的程序员，喜欢黑暗和雨天。他住在母亲的地下室里，骑摩托车，喜欢青蛙和视频游戏。
最爱的礼物：冰冻泪晶、南瓜汤、刺身、虚空蛋
喜欢的礼物：黑曜石、所有汤类（除了鱿鱼墨汁汤）
生日：冬季 10 日
位置：山上的木匠铺（地下室）

谢恩 (Shane)
在 JojaMart 工作的沮丧男子，初期对玩家冷淡。他喜欢啤酒和披萨，养着一只名叫查理的宠物鸡。
最爱的礼物：啤酒、热辣椒、胡椒罐、披萨
喜欢的礼物：所有鸡蛋（虚空蛋除外）
生日：春季 20 日
位置：玛妮牧场

艾利克斯 (Alex)
自信的运动员，最初显得有些傲慢。他热爱橄榄球，梦想成为职业运动员。
最爱的礼物：完美早餐、三文鱼晚餐
喜欢的礼物：所有鸡蛋（除了虚空蛋）、所有普遍喜爱的礼物
生日：夏季 13 日
位置：1 河路（与祖父母同住）

阿比盖尔 (Abigail)
冒险精神的紫发女孩，喜欢探险和打游戏。她对神秘学和超自然现象感兴趣。
最爱的礼物：紫水晶、河豚、南瓜、辣根萝卜汁
喜欢的礼物：所有宝石、所有矿石、黑莓脆皮
生日：秋季 13 日
位置：皮埃尔杂货店（楼上）

海莉 (Haley)
时尚的金发女孩，初期显得肤浅和傲慢。她喜欢摄影，有一个姐姐艾米丽。
最爱的礼物：椰子、水果沙拉、粉色蛋糕、向日葵
喜欢的礼物：所有水果（除了山核桃和榛子）、所有宝石
生日：春季 14 日
位置：2 柳巷街（与艾米丽同住）

莉亚 (Leah)
独立的艺术家，住在森林里的小屋。她喜欢自然，从城市搬来寻找灵感。
最爱的礼物：山羊奶酪、罂粟籽松糕、沙拉、蔬菜杂烩、松露、葡萄酒
喜欢的礼物：所有水果（除了山核桃）、所有蘑菇、漂流木
生日：冬季 23 日
位置：秘密森林南部的小屋

玛鲁 (Maru)
聪明的护士兼发明家，对科学和技术充满热情。她是罗宾和德米特里厄斯的女儿。
最爱的礼物：电池组、菜花、奶酪花椰菜、钻石、大黄派、草莓
喜欢的礼物：所有宝石、铜锭、金锭、铱锭、铁锭、石英
生日：夏季 10 日
位置：山上的木匠铺

潘妮 (Penny)
温柔的年轻女子，与酗酒的母亲帕姆住在一起。她教育镇上的孩子们，梦想有个更好的生活。
最爱的礼物：钻石、绿宝石、甜瓜、罂粟、罂粟籽松糕、红之盛宴、根茎拼盘、沙漠图腾
喜欢的礼物：所有烹饪食物（除了面包、炒蘑菇、奇怪的小面包）、所有水果、所有牛奶
生日：秋季 2 日
位置：2 河路（拖车）

艾米丽 (Emily)
热情而古怪的裁缝，相信水晶疗法和梦境。她在星之果实酒吧工作。
最爱的礼物：紫水晶、海蓝宝石、布料、绿宝石、玉髓、红宝石、黄玉、生存汉堡包、羊毛
喜欢的礼物：所有宝石、鹦鹉螺壳、所有矿石
生日：春季 27 日
位置：2 柳巷街（与海莉同住）

作物种植指南

春季作物
防风草：种子 20 金，4 天成熟，售价 35 金。适合第一年初期快速赚钱。
花椰菜：种子 80 金，12 天成熟，售价 175 金。有机会长成巨型作物（3x3）。
土豆：种子 50 金，6 天成熟，售价 80 金。收获时有概率获得多个土豆。
大蒜：种子 40 金，4 天成熟，售价 60 金。
草莓：种子 100 金（春季花舞节购买），8 天成熟后每 4 天再次收获，售价 120 金。春季最赚钱的作物。

夏季作物
蓝莓：种子 80 金，13 天成熟后每 4 天再次收获，每次收获 3 个，售价 50 金/个。夏季最赚钱的作物。
甜瓜：种子 80 金，12 天成熟，售价 250 金。有机会长成巨型作物。
热辣椒：种子 40 金，5 天成熟后每 3 天再次收获，售价 40 金。
番茄：种子 50 金，11 天成熟后每 4 天再次收获，售价 60 金。
啤酒花：种子 60 金，11 天成熟后每天收获，售价 25 金。用于酿造淡啤酒。

秋季作物
蔓越莓：种子 240 金，7 天成熟后每 5 天再次收获，每次收获 2 个，售价 75 金/个。秋季最赚钱的作物。
南瓜：种子 100 金，13 天成熟，售价 320 金。有机会长成巨型作物。
葡萄：种子 60 金，10 天成熟后每 3 天再次收获，售价 80 金。
朝鲜蓟：种子 30 金，8 天成熟，售价 160 金。
玉米：种子 150 金，14 天成熟后每 4 天再次收获，售价 50 金。可在夏季和秋季种植。

冬季作物
冬季种子：只能通过冬季觅食包或制作获得。包含冬根、水晶果实、雪山药、番红花。
温室：解锁温室后可以全年种植任何作物。推荐种植古代水果或草莓。

钓鱼指南

春季鱼类
鲶鱼：出现在河流中（雨天），6:00 AM - 12:00 AM，难度 75。
鲥鱼：出现在河流中，9:00 AM - 2:00 AM，难度 45。
太阳鱼：出现在河流中（晴天），6:00 AM - 7:00 PM，难度 35。
传奇鱼 - 传说之鱼：山地湖泊，雨天，6:00 AM - 7:00 PM，钓鱼等级 10，难度 110。

夏季鱼类
虹鳟鱼：河流和山地湖泊，6:00 AM - 7:00 PM（晴天），难度 45。
章鱼：海洋，6:00 AM - 1:00 PM，难度 95。
河豚：海洋（晴天），12:00 PM - 4:00 PM，难度 80。价值 200 金。
传奇鱼 - 深红鱼：海洋，夏季，6:00 AM - 8:00 PM，钓鱼等级 5，难度 95。

秋季鱼类
虎鳟鱼：河流，6:00 AM - 7:00 PM，难度 60。
大嘴鲈鱼：山地湖泊，6:00 AM - 7:00 PM，难度 50。
鳗鱼：海洋（雨天），4:00 PM - 2:00 AM，难度 70。
传奇鱼 - 冰川鱼：秘密森林，下午和晚上，钓鱼等级 6，难度 100。

冬季鱼类
鲑鱼：河流，6:00 AM - 7:00 PM，难度 50。
金枪鱼：海洋（6:00 AM - 7:00 PM），难度 70。价值 100 金。
沙丁鱼：海洋，6:00 AM - 7:00 PM，难度 30。
传奇鱼 - 突变鲤鱼：下水道，全天，钓鱼等级 3，难度 80。
传奇鱼 - 鮟鱇鱼：北部海滩，冬季，雨天，钓鱼等级 10，难度 125。

螃蟹笼
螃蟹笼可以放置在任何水域自动捕获海鲜：
- 海洋：龙虾、螃蟹、蚌、牡蛎、虾、海胆、海螺
- 淡水：小龙虾、蜗牛、淡菜、鲈鱼

节日活动

春季
蛋节（春季 13 日）：寻找彩蛋活动，获胜可得草莓种子。
花舞节（春季 24 日）：可以购买稀有的郁金香和爵士花种子，以及草莓种子（100 金/包）。

夏季
露天电影院（夏季 11 日）：观看电影，与村民互动。
鲁奥节（夏季 11 日、28 日）：与村民一起游泳。

秋季
星露谷展览会（秋季 16 日）：展示物品获得星币，用星币购买稀有物品。
万灵节（秋季 27 日）：迷宫和商店，可以购买万灵节南瓜（5000 金）。

冬季
冬星节（冬季 25 日）：为随机村民准备礼物。
冰雪节（冬季 8 日）：钓鱼比赛、商店和装饰活动。

赚钱方法

初期（第一年春季）
1. 种植防风草和土豆快速回本
2. 在花舞节购买草莓种子
3. 春季后期专注种植草莓
4. 每天检查垃圾桶（可能有免费物品）
5. 收集春季觅食物品（野山葵、水仙花、韭葱、蒲公英）

中期（第一年夏秋季）
1. 夏季专注种植蓝莓
2. 秋季专注种植蔓越莓
3. 建造加工设备（保存罐、酿酒桶）将农产品加工增值
4. 养殖动物（鸡、牛）生产鸡蛋和牛奶
5. 钓鱼赚取额外收入
6. 探索矿洞收集矿石和宝石

后期（第二年及以后）
1. 升级为酿酒桶和油制造机
2. 种植古代水果（温室）
3. 养殖猪收集松露
4. 建立古代水果酿酒产业链（利润最高）
5. 完成社区中心或JojaMart路线
6. 骷髅洞穴（沙漠）挖矿收集铱矿石

最赚钱的产品（每单位）
1. 古代水果酒（2250-4500 金）
2. 星之果实酒（2250-4500 金）
3. 松露油（1065 金）
4. 山羊奶酪（400-800 金）
5. 恐龙蛋黄酱（800 金）

矿洞攻略

普通矿洞（120 层）
层数 1-39：铜矿石、石头、宝石
层数 40-79：铁矿石、铜矿石、石英、冷冻晶洞（80层）
层数 80-119：金矿石、铁矿石、钻石、紫水晶
第 120 层：底部，奖励骷髅钥匙

重要层数
- 第 5 层：第一个电梯
- 第 10 层：古代种子有概率掉落
- 第 20 层：火石晶洞
- 第 80 层：水晶晶洞

骷髅洞穴（沙漠）
解锁条件：完成地窖藏品包获得骷髅钥匙
特点：无限深度，铱矿石从层数 50 开始出现
怪物：蛇、木乃伊、飞龙、紫色史莱姆
掉落：铱矿石、史前卷轴、恐龙蛋

战斗技巧
1. 选择合适的武器（剑速度快，锤子范围大，匕首攻击快）
2. 带足够的食物补充生命和能量
3. 使用炸弹快速清理石头和怪物
4. 找到楼梯或洞口快速下降
5. 穿戴戒指增强属性（发光戒指、战士戒指等）

社区中心包裹

工匠包裹室
春季觅食包：需要野山葵、水仙花、韭葱、蒲公英
夏季觅食包：需要葡萄、香料浆果、甜豌豆、鲑莓
秋季觅食包：需要普通蘑菇、野梅、榛子、黑莓
冬季觅食包：需要冬根、水晶果实、雪山药、番红花
建筑包：需要木材 99、石头 99、硬木 10
异国情调的觅食包：需要椰子、仙人掌果实、洞穴胡萝卜、红树莓、紫蘑菇、枫糖浆、牡蛎、石榴、贝壳、红叶

食品储藏室
春季作物包：需要防风草、青豆、花椰菜、土豆
夏季作物包：需要番茄、热辣椒、蓝莓、甜瓜
秋季作物包：需要玉米、茄子、南瓜、山药
优质作物包：需要金星防风草 5、金星甜瓜 5、金星南瓜 5、金星玉米 5
动物产品包：需要大牛奶、大鸡蛋（棕）、大鸡蛋（白）、大山羊奶、羊毛、鸭蛋
工匠产品包：需要松露油、布料、山羊奶酪、蜂蜜、果冻、苹果、杏子、橙子、桃子、石榴、樱桃

鱼缸
河鱼包：需要太阳鱼、鲶鱼、鲥鱼、虎鳟鱼
湖鱼包：需要大嘴鲈鱼、鲤鱼、大头鱼、鲟鱼
海洋鱼包：需要沙丁鱼、金枪鱼、红鲷鱼、罗非鱼
夜间钓鱼包：需要海鳗、鲶鱼（夜间）、龙虾
特殊鱼类包：需要河豚、鬼鱼、木跷鱼、沙鱼
螃蟹笼包：需要龙虾、螃蟹、虾、小龙虾、蚌、牡蛎、淡菜、蛤、海胆、蜗牛、鲈鱼、海螺

锅炉室
铁匠包：需要铜锭、铁锭、金锭
地质学家包：需要石英、土水晶、冷冻泪晶、火石
冒险家包：需要史莱姆 99、蝙蝠翅膀 10、太阳能精华、虚空精华

布告栏（最难完成）
厨师包：需要枫糖浆、油、葡萄、玉米、松露、罂粟、夏季香料浆果、生鱼片、苹果、奶酪、小麦面粉
染料包：需要红卷心菜、向日葵、鸭毛、水母、海参、兔子脚
饲料包：需要小麦 10、干草 10、苹果 3
魔法师包：需要紫蘑菇、红蘑菇、绿藻、白藻
失踪的包裹：在公交车站附近找到并归还

地窖
25000 金包：支付 25000 金
2500 金包：支付 2500 金
5000 金包：支付 5000 金
10000 金包：支付 10000 金
奖励：解锁骷髅钥匙进入骷髅洞穴

技能升级建议

农业技能
推荐路线：耕种者 → 农业学家（所有作物生长速度加快 10%）
备选路线：耕种者 → 手工艺人（手工制品售价增加 40%）
最佳作物：古代水果、草莓、蓝莓、蔓越莓

采矿技能
推荐路线：矿工 → 勘探者（找到宝石的概率加倍）
备选路线：地质学家 → 挖掘者（找到晶洞的概率加倍）
快速升级：每天去矿洞，破坏所有石头

觅食技能
推荐路线：采集者 → 植物学家（觅食物品总是金星品质）
备选路线：采集者 → 追踪者（显示可觅食物品的位置）
快速升级：每天收集野生植物、种植野生种子

钓鱼技能
推荐路线：渔夫 → 海盗（有概率找到宝藏）
备选路线：捕手 → 渔夫（鱼售价增加 25%）
快速升级：每天钓鱼，优先钓高难度的鱼

战斗技能
推荐路线：战士 → 蛮力（伤害增加 15%）
备选路线：侦察兵 → 暴击（暴击概率增加 50%）
快速升级：在矿洞中击杀怪物

农场布局建议

标准农场
优点：大量种植空间，平坦地形
缺点：没有特殊资源
适合：新手玩家，喜欢大规模种植

河边农场
优点：大量钓鱼点，可以在农场钓鱼
缺点：种植空间较少
适合：喜欢钓鱼的玩家

森林农场
优点：可再生的硬木、觅食物品每天刷新
缺点：种植空间分散
适合：喜欢觅食和收集的玩家

山顶农场
优点：采矿节点每天刷新，有采石场
缺点：种植空间有限且不规则
适合：喜欢采矿的玩家

荒野农场
优点：夜晚有怪物出现，适合练级
缺点：种植空间有限，需要注意安全
适合：喜欢战斗的玩家

四角农场
优点：四个不同区域，适合多样化发展
缺点：空间分散
适合：想尝试所有玩法的玩家

海滩农场
优点：独特的供应箱机制，大量钓鱼点
缺点：不能使用洒水器
适合：有经验的玩家，挑战模式

实用建议和技巧

日常优先级
1. 收获成熟的作物
2. 浇水（使用洒水器后可省略）
3. 照顾动物（喂食、挤奶、剪毛）
4. 收集加工产品（酿酒桶、保存罐）
5. 社交互动（送礼、对话）
6. 探索矿洞或钓鱼
7. 在商店购买种子

时间管理
- 凌晨 2:00 会强制睡觉并扣能量
- 商店营业时间：皮埃尔 9:00 AM - 5:00 PM
- JojaMart：9:00 AM - 11:00 PM（更方便但价格贵）
- 尽量在下午 6:00 前回家完成日常任务

能量管理
- 携带食物补充能量
- 建造温泉解锁后可以免费恢复能量
- 吃饭食堂（星之果实酒吧）可以恢复能量

金钱管理初期
- 不要过度购买种子，保留应急资金
- 优先升级工具（水壶 → 斧头 → 镐子）
- 存钱购买背包升级（2000 金、10000 金）
- 季节最后几天注意不要浪费种子

经验分享
- 每季度第一天购买所有种子
- 使用质量洒水器节省时间
- 温室解锁后种植高价值作物
- 地窖解锁后专注酿酒业
- 完成社区中心比 JojaMart 路线奖励更好
- 与村民建立友谊可以解锁特殊事件和配方
- 每周日电视节目"占星女王"会提示喜欢的村民

稀有物品获取

古代种子
获取方法：
1. 矿洞层数 10-40 击杀虫子和飞虫有概率掉落古代种子文物
2. 捐赠给博物馆后获得古代种子包和配方
3. 种子制造机有 0.5% 概率从古代水果产出古代种子
价值：古代水果酒是游戏中最赚钱的产品之一

棱镜碎片
获取方法：
1. 骷髅洞穴击杀怪物掉落（概率 0.05%）
2. 神秘石头掉落
3. 宝藏房间
用途：与暗影精灵交易获得银河之剑，制作婚戒

兔子脚
获取方法：
1. 养兔子有概率掉落（需要高好感度）
2. 蛇骷髅掉落
3. 商队随机出售
用途：增加每日幸运值，稀有礼物

恐龙蛋
获取方法：
1. 骷髅洞穴击杀恐龙掉落
2. 挖掘斑点（需要锄头）
3. 钓鱼宝箱
用途：放入恐龙蛋孵化器获得恐龙（可以定期产恐龙蛋）

超级海参
获取方法：
1. 夏季和冬季在海洋钓鱼
2. 秋季海洋（6:00 AM - 7:00 PM）
用途：治愈、礼物（哈维最爱）

神奇的甜蜜豆米糕
获取方法：
1. 星之果实酒吧的起重机游戏
2. 商队随机出售
用途：永久增加属性（每种只能吃一次）

